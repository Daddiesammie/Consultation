<nav class="fixed top-0 left-0 right-0 z-50 bg-gradient-to-r from-primary-700 to-primary-900 rounded-b-3xl shadow-lg">
    <div class="h-20 mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-20">
            <!-- Logo and Brand -->
            <div class="flex items-center">
                <div class="flex-shrink-0">
                    <a href="{% url 'core:home' %}" class="flex items-center space-x-2">
                        {% if site_settings.logo %}
                            <img src="{{ site_settings.logo.url }}" 
                                 alt="{{ site_settings.site_name }}" 
                                 class="h-12 w-auto">
                        {% else %}
                            <span class="text-white font-bold text-2xl tracking-tight">D&D</span>
                            <span class="text-primary-200 font-medium">Consulting</span>
                        {% endif %}
                    </a>
                </div>

                <!-- Desktop Menu -->
                <div class="hidden lg:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="{% url 'core:home' %}" class="text-white hover:bg-primary-600 px-3 py-2 rounded-md transition duration-300">Home</a>
                        
                        <!-- About Dropdown -->
                        <div class="relative group" x-data="{ open: false }" @click.away="open = false">
                            <button @click="open = !open" 
                                    class="text-white hover:bg-primary-600 px-3 py-2 rounded-md inline-flex items-center transition duration-300">
                                <span>About</span>
                                <svg class="ml-2 h-4 w-4 transform" :class="{'rotate-180': open}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                                </svg>
                            </button>
                            <div x-show="open"
                                 x-transition:enter="transition ease-out duration-200"
                                 x-transition:enter-start="opacity-0 transform scale-95"
                                 x-transition:enter-end="opacity-100 transform scale-100"
                                 class="absolute left-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5">
                                <div class="py-1">
                                    <a href="{% url 'core:about' %}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-primary-50">About Us</a>
                                    <a href="{% url 'core:portfolio' %}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-primary-50">Portfolio</a>
                                    <a href="{% url 'blog:post_list' %}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-primary-50">Blog</a>
                                </div>
                            </div>
                        </div>

                        <!-- Services Dropdown -->
                        <div class="relative group" x-data="{ open: false }" @click.away="open = false">
                            <button @click="open = !open"
                                    class="text-white hover:bg-primary-600 px-3 py-2 rounded-md inline-flex items-center transition duration-300">
                                <span>Services</span>
                                <svg class="ml-2 h-4 w-4 transform" :class="{'rotate-180': open}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                                </svg>
                            </button>
                            <div x-show="open"
                                 x-transition:enter="transition ease-out duration-200"
                                 x-transition:enter-start="opacity-0 transform scale-95"
                                 x-transition:enter-end="opacity-100 transform scale-100"
                                 class="absolute left-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5">
                                <div class="py-1">
                                    <a href="{% url 'core:services' %}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-primary-50">Our Services</a>
                                    <a href="{% url 'consultations:book_consultation' %}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-primary-50">Book Consultation</a>
                                </div>
                            </div>
                        </div>

                        <a href="{% url 'core:contact' %}" class="text-white hover:bg-primary-600 px-3 py-2 rounded-md transition duration-300">Contact</a>
                    </div>
                </div>
            </div>


            <!-- Auth Links (Desktop) -->
            <!-- Auth Links (Desktop) -->
<div class="hidden lg:block">
    <div class="flex items-center space-x-4">
        {% if user.is_authenticated %}
            <div class="relative" x-data="{ open: false }" @click.away="open = false">
                <button @click="open = !open"
                        class="text-white hover:bg-primary-600 px-3 py-2 rounded-md inline-flex items-center transition duration-300">
                    <span>{{ user.get_full_name|default:user.username }}</span>
                    <svg class="ml-2 h-4 w-4 transform" :class="{'rotate-180': open}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                    </svg>
                </button>
                
                <div x-show="open"
                     x-transition:enter="transition ease-out duration-200"
                     x-transition:enter-start="opacity-0 transform scale-95"
                     x-transition:enter-end="opacity-100 transform scale-100"
                     class="absolute right-0 mt-2 w-48 rounded-md shadow-xl bg-white ring-1 ring-black ring-opacity-5">
                    <div class="py-1">
                        <a href="{% url 'accounts:dashboard' %}" 
                           class="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-primary-50">
                            <svg class="mr-3 h-4 w-4 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                            </svg>
                            Dashboard
                        </a>
                        
                        <a href="{% url 'accounts:profile' %}" 
                           class="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-primary-50">
                            <svg class="mr-3 h-4 w-4 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                            </svg>
                            Profile
                        </a>
                        
                        <form method="POST" action="{% url 'accounts:logout' %}" class="block">
                            {% csrf_token %}
                            <button type="submit" 
                                    class="w-full flex items-center px-4 py-2 text-sm text-red-600 hover:bg-red-50">
                                <svg class="mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
                                </svg>
                                Logout
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        {% else %}
            <a href="{% url 'accounts:login' %}" 
               class="text-white hover:bg-primary-600 px-3 py-2 rounded-md transition duration-300">
                Login
            </a>
            <a href="{% url 'accounts:register' %}" 
               class="bg-white text-primary-700 hover:bg-primary-50 px-4 py-2 rounded-md font-medium transition duration-300">
                Register
            </a>
        {% endif %}
    </div>
</div>


            <!-- Mobile Menu Button -->
            <div class="lg:hidden">
                <button type="button" onclick="toggleMobileMenu()" class="text-white hover:bg-primary-600 p-2 rounded-md transition duration-300">
                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- Mobile Menu -->
    <div id="mobile-menu" class="hidden lg:hidden">
        <div class="px-2 pt-2 pb-3 space-y-1">
            <a href="{% url 'core:home' %}" class="text-white hover:bg-primary-600 block px-3 py-2 rounded-md transition duration-300">Home</a>
            
            <!-- Mobile Accordions -->
            <div class="mobile-accordion">
                <button onclick="toggleAccordion('about-accordion')" class="w-full text-white hover:bg-primary-600 px-3 py-2 rounded-md text-left flex justify-between items-center transition duration-300">
                    <span>About</span>
                    <svg class="h-4 w-4 transform transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                    </svg>
                </button>
                <div id="about-accordion" class="hidden pl-4 space-y-1">
                    <a href="{% url 'core:about' %}" class="text-primary-100 hover:bg-primary-600 block px-3 py-2 rounded-md transition duration-300">About Us</a>
                    <a href="{% url 'core:portfolio' %}" class="text-primary-100 hover:bg-primary-600 block px-3 py-2 rounded-md transition duration-300">Portfolio</a>
                    <a href="{% url 'blog:post_list' %}" class="text-primary-100 hover:bg-primary-600 block px-3 py-2 rounded-md transition duration-300">Blog</a>
                </div>
            </div>

            <div class="mobile-accordion">
                <button onclick="toggleAccordion('services-accordion')" class="w-full text-white hover:bg-primary-600 px-3 py-2 rounded-md text-left flex justify-between items-center transition duration-300">
                    <span>Services</span>
                    <svg class="h-4 w-4 transform transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                    </svg>
                </button>
                <div id="services-accordion" class="hidden pl-4 space-y-1">
                    <a href="{% url 'core:services' %}" class="text-primary-100 hover:bg-primary-600 block px-3 py-2 rounded-md transition duration-300">Our Services</a>
                    <a href="{% url 'consultations:book_consultation' %}" class="text-primary-100 hover:bg-primary-600 block px-3 py-2 rounded-md transition duration-300">Book Consultation</a>
                </div>
            </div>

            <a href="{% url 'core:contact' %}" class="text-white hover:bg-primary-600 block px-3 py-2 rounded-md transition duration-300">Contact</a>

            {% if user.is_authenticated %}
                <a href="{% url 'accounts:dashboard' %}" class="text-white hover:bg-primary-600 block px-3 py-2 rounded-md transition duration-300">Dashboard</a>
                <a href="{% url 'accounts:profile' %}" class="text-white hover:bg-primary-600 block px-3 py-2 rounded-md transition duration-300">Profile</a>
                <form method="POST" action="{% url 'accounts:logout' %}">
                    {% csrf_token %}
                    <button type="submit" class="w-full text-white hover:bg-primary-600 text-left px-3 py-2 rounded-md transition duration-300">Logout</button>
                </form>
            {% else %}
                <a href="{% url 'accounts:login' %}" class="text-white hover:bg-primary-600 block px-3 py-2 rounded-md transition duration-300">Login</a>
                <a href="{% url 'accounts:register' %}" class="text-white hover:bg-primary-600 block px-3 py-2 rounded-md transition duration-300">Register</a>
            {% endif %}
        </div>
    </div>
</nav>
<script src="//unpkg.com/alpinejs" defer></script>
<script>
function toggleMobileMenu() {
    const mobileMenu = document.getElementById('mobile-menu');
    mobileMenu.classList.toggle('hidden');
}

function toggleAccordion(id) {
    const accordion = document.getElementById(id);
    const button = accordion.previousElementSibling;
    const icon = button.querySelector('svg');
    
    accordion.classList.toggle('hidden');
    icon.classList.toggle('rotate-180');
}
</script>
